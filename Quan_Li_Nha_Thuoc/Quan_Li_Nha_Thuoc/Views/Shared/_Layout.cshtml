<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>@ViewBag.Title - ElectroShop</title>

    @Styles.Render("~/Content/css")
    @Scripts.Render("~/bundles/modernizr")

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" crossorigin="anonymous" referrerpolicy="no-referrer" />

    <style>
    :root{
      --brand-blue: #0d6efd;
      --brand-blue-600: #0b5ed7;
      --brand-blue-100: #e9f2ff;
      --muted: #6c757d;
      --surface: #ffffff;
      --glass: rgba(255,255,255,0.85);
    }

    /* reset nhỏ để header gọn */
    .sticky-top { backdrop-filter: blur(6px); }

    /* Top bar */
    .top-bar {
      background: linear-gradient(90deg, rgba(13,110,253,0.04), transparent);
      color: var(--brand-blue-600);
      font-size: 0.85rem;
      padding: 0.35rem 0;
    }
    .top-bar a { color: var(--brand-blue-600); text-decoration: none; }
    .top-bar a:hover { text-decoration: underline; }

    /* Main header */
    .header-main {
      background: var(--glass);
      border-bottom: 1px solid rgba(13,110,253,0.06);
      padding: 0.7rem 0;
      box-shadow: 0 6px 18px rgba(20,30,60,0.04);
      backdrop-filter: saturate(1.1) blur(4px);
    }

    /* Brand */
    .navbar-brand { color: var(--brand-blue-600); font-weight: 800; display:flex; align-items:center; gap:.6rem; }
    .logo-icon {
      width:46px;height:46px;border-radius:12px;
      display:inline-flex;align-items:center;justify-content:center;
      background: linear-gradient(135deg, var(--brand-blue), var(--brand-blue-600));
      color:white;font-size:1.05rem; box-shadow: 0 8px 24px rgba(13,110,253,0.12);
    }
    .brand-text { font-size:1.28rem; letter-spacing:0.2px; }

    /* Search */
    .search-wrap { max-width:760px; width:100%; }
    .search-input {
      height:48px; border-radius: 12px; padding:0.5rem 0.9rem; box-shadow:none; border:1px solid rgba(13,110,253,0.08);
    }
    .search-btn {
      border-radius: 10px; margin-left:8px; height:48px;
      padding:0 14px; display:flex; align-items:center; justify-content:center;
      box-shadow: 0 6px 14px rgba(13,110,253,0.06);
    }
    /* suggestion box */
    .search-suggestions {
      position:absolute; left:0; right:0; top:calc(100% + 8px);
      background:white; border-radius:10px; box-shadow:0 10px 30px rgba(0,0,0,0.08);
      z-index:1100; overflow:hidden; border:1px solid rgba(0,0,0,0.04);
      display:none;
    }
    .search-suggestions .item { padding:10px 14px; cursor:pointer; }
    .search-suggestions .item:hover { background:var(--brand-blue-100); color:var(--brand-blue-600); }

    /* Header icons */
    .header-actions .nav-link {
      color:#4b5563; font-size:1.15rem; padding:.45rem .6rem; border-radius:10px; transition:.12s;
    }
    .header-actions .nav-link:hover, .header-actions .nav-link:focus {
      background:var(--brand-blue-100); color:var(--brand-blue-600); transform:translateY(-2px);
    }
    .icon-label { font-size:0.75rem; display:block; text-align:center; margin-top:2px; color:var(--muted); }

    /* badge */
    .badge-cart {
      position:absolute; top:-6px; right:-6px; min-width:20px;height:20px;
      padding:0 6px; display:inline-flex; align-items:center; justify-content:center;
      border-radius:999px; background:#ff3b30; color:#fff; font-size:0.67rem; font-weight:700;
      box-shadow:0 6px 14px rgba(255,59,48,0.12);
    }

    /* user dropdown (avatar) */
    .user-avatar {
      width:40px;height:40px;border-radius:999px;background:linear-gradient(135deg,#fff, rgba(13,110,253,0.06));
      display:inline-flex;align-items:center;justify-content:center;color:var(--brand-blue-600);font-weight:700;
      border:1px solid rgba(13,110,253,0.08);
    }

    .dropdown-menu { border-radius:12px; padding:.3rem; min-width:220px; }

    /* accessibility */
    .nav-link:focus { outline: 3px solid rgba(13,110,253,0.12); outline-offset:3px; border-radius:8px; }
    </style>
</head>
<body>
    <header class="sticky-top">
        <!-- topbar: hotline / contact -->
        <div class="top-bar">
            <div class="container d-flex justify-content-between align-items-center">
                <div class="d-flex align-items-center small">
                    <a href="tel:19001234" class="me-3"><i class="fas fa-phone-alt me-1"></i>1900 1234</a>
                    <a href="mailto:support@electroshop.com"><i class="fas fa-envelope me-1"></i>support@electroshop.com</a>
                </div>
                <div>
                    <a href="#" class="me-2" aria-label="facebook"><i class="fab fa-facebook-f"></i></a>
                    <a href="#" class="me-2" aria-label="youtube"><i class="fab fa-youtube"></i></a>
                </div>
            </div>
        </div>

        <!-- main navbar -->
        <nav class="navbar navbar-expand-lg header-main">
            <div class="container align-items-center">
                <a class="navbar-brand" href="@Url.Action("Index","Home")">
                    <span class="logo-icon" aria-hidden="true"><i class="fas fa-bolt"></i></span>
                    <span class="brand-text">ElectroShop</span>
                </a>

                <button class="navbar-toggler border-0" type="button" data-bs-toggle="collapse" data-bs-target="#mainNav"
                        aria-controls="mainNav" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <div class="collapse navbar-collapse" id="mainNav">
                    <!-- search -->
                    <div class="mx-auto search-wrap position-relative">
                        <form class="d-flex align-items-center w-100" role="search" onsubmit="return false;">
                            <input id="searchInput" class="form-control search-input" type="search" placeholder="Bạn tìm gì hôm nay? Ví dụ: điện thoại, laptop..."
                                   aria-label="Tìm sản phẩm" autocomplete="off" />
                            <button class="btn btn-primary search-btn" type="button" aria-label="Tìm kiếm" onclick="performSearch()">
                                <i class="fas fa-search"></i>
                            </button>
                        </form>
                        <div id="searchSuggestions" class="search-suggestions" role="listbox" aria-label="Gợi ý tìm kiếm"></div>
                    </div>

                    <!-- icons -->
                    <ul class="navbar-nav ms-auto align-items-center header-actions">
                        <li class="nav-item me-1 text-center">
                            <a class="nav-link" href="#" title="Yêu thích" aria-label="Yêu thích">
                                <i class="fas fa-heart"></i>
                                <span class="icon-label">Yêu thích</span>
                            </a>
                        </li>

                        <li class="nav-item position-relative me-2 text-center">
                            <a class="nav-link" href="@Url.Action("Cart","Order")" title="Giỏ hàng" aria-label="Giỏ hàng">
                                <i class="fas fa-shopping-cart"></i>
                                @{
                                    var cartCount = (ViewBag.CartCount ?? 0);
                                }
                                @if (cartCount > 0)
                                {
                                    <span class="badge-cart">@cartCount</span>
                                }
                                <span class="icon-label">Giỏ hàng</span>
                            </a>
                        </li>

                        <li class="nav-item dropdown user-dropdown">
                            <a class="nav-link dropdown-toggle" href="#" id="navbarDropdownUser" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                                <i class="fas fa-user-circle user-icon"></i>
                            </a>

                            <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="navbarDropdownUser">
                                @if (User?.Identity?.IsAuthenticated == true)
                                {
                                    <li><h6 class="dropdown-header">Chào, @User.Identity.Name</h6></li>
                                    <li><a class="dropdown-item" href="@Url.Action("Profile","Account")">Thông tin tài khoản</a></li>
                                    <li><a class="dropdown-item" href="@Url.Action("OrderHistory","Account")">Lịch sử mua hàng</a></li>
                                    <li><hr class="dropdown-divider"></li>
                                    <li>
                                        <form action="@Url.Action("Logout","Account")" method="post" class="d-inline">
                                            @Html.AntiForgeryToken()
                                            <button type="submit" class="dropdown-item text-danger">Đăng xuất</button>
                                        </form>
                                    </li>
                                }
                                else
                                {
                                    <li><a class="dropdown-item" href="@Url.Action("Index","Login")">Đăng nhập</a></li>
                                    <li><a class="dropdown-item" href="@Url.Action("Index","Register")">Đăng ký</a></li>
                                }
                            </ul>
                        </li>
                    </ul>
                </div>
            </div>
        </nav>
    </header>

    <div class="container body-content">
        @RenderBody()
    </div>

    <footer></footer>

    <!-- Scripts: giữ jQuery nếu project cần, Bootstrap bundle (Popper) -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>

    <script>
    // sample: search suggestion UI (frontend only)
    const suggestions = ["iPhone 15", "Laptop gaming", "Tai nghe bluetooth", "Sạc dự phòng", "Smart TV 4K"];
    const input = document.getElementById('searchInput');
    const box = document.getElementById('searchSuggestions');

    input.addEventListener('input', function() {
      const v = this.value.trim().toLowerCase();
      if (!v) { box.style.display = 'none'; return; }
      const match = suggestions.filter(s => s.toLowerCase().includes(v)).slice(0,6);
      if (match.length === 0) { box.style.display = 'none'; return; }
      box.innerHTML = match.map(m => `<div class="item" role="option" onclick="chooseSuggestion('${m.replace(/'/g,"\\'")}')">${m}</div>`).join('');
      box.style.display = 'block';
    });

    document.addEventListener('click', function(e) {
      if (!e.target.closest('.search-wrap')) box.style.display = 'none';
    });

    function chooseSuggestion(t) {
      input.value = t;
      box.style.display = 'none';
      performSearch();
    }

    function performSearch() {
      const q = input.value.trim();
      if (!q) return;
      // redirect tới search page (bạn đổi url tùy route)
      window.location.href = '@Url.Action("Search","Product")?q=' + encodeURIComponent(q);
    }
    </script>

    @RenderSection("scripts", required: false)
</body>
</html>
